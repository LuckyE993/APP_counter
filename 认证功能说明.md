# 认证功能说明

## 概述

本应用已集成简单而安全的JWT认证机制，确保只有授权用户才能访问记账功能。

## 特性

- **JWT Token认证**: 使用行业标准的JWT token进行身份验证
- **长期有效**: Token默认30天有效期，减少重复登录
- **自动持久化**: Token自动保存在浏览器本地存储
- **自动跳转**: 未登录用户自动跳转到登录页面
- **全面保护**: 所有API端点都需要认证（除登录接口）

## 默认账号

- **用户名**: `admin`
- **密码**: `admin123`

> ⚠️ **安全提醒**: 部署到生产环境时，请务必修改默认密码！

## 配置说明

在 `backend/.env` 文件中配置认证参数：

```env
# JWT密钥 - 生产环境必须更换
SECRET_KEY=your-very-secure-secret-key-change-in-production

# 管理员账号
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your-secure-password

# Token过期时间（分钟）
ACCESS_TOKEN_EXPIRE_MINUTES=43200  # 30天
```

## 生成安全密钥

```bash
python3 -c "import secrets; print(secrets.token_urlsafe(32))"
```

## 使用流程

1. **首次访问**: 自动跳转到登录页面
2. **输入凭据**: 使用管理员账号登录
3. **自动保存**: Token保存到本地存储
4. **正常使用**: 30天内无需重复登录
5. **自动续期**: Token过期后自动跳转登录

## API端点

### 登录
```http
POST /api/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

### 访问受保护资源
```http
GET /api/balance
Authorization: Bearer <your-jwt-token>
```

## 安全建议

1. **修改默认密码**: 生产环境必须更换默认密码
2. **使用强密钥**: SECRET_KEY应该是随机生成的长字符串
3. **HTTPS部署**: 生产环境建议使用HTTPS
4. **定期更新**: 定期更换密码和密钥

## 测试认证功能

运行测试脚本：
```bash
cd backend
python test_auth.py
```

确保后端服务正在运行（端口8000）。